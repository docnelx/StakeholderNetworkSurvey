"'Section II_EN' As screen":
    BackgroundImage: =
    Fill: =RGBA(237, 237, 237, 1)
    OnHidden: |-
        =Patch(colTimeRecorder, Last(colTimeRecorder), {End: Now()});
    OnVisible: |-
        =Set(_currentPage,"Section II_EN");
        Set(_popup,false);Collect(colTimeRecorder,{Page: Self.Name,Start:Now(),End: ""});

    Rectangle5_6 As rectangle:
        Fill: =RGBA(255, 255, 255, 0.8)
        Height: =557
        Width: =1366
        Y: =136
        ZIndex: =1

    Rectangle5_63 As rectangle:
        Fill: =RGBA(237, 237, 237, 1)
        Height: =86
        Width: =1366
        Y: =682
        ZIndex: =2

    Arrow2_2 As arrow:
        DisplayMode: =If(CountRows(Filter(ForAll(galsectionII.AllItems,drpchanges.Selected.Value),Not(Value in drpchangesArray)))> 0 ||  CountRows(Filter(ForAll(galsectionII.AllItems,drpcontributions.Selected.Value),Not(Value in drpcontributionsArray)))>0,DisplayMode.Disabled,DisplayMode.Edit)
        Fill: =RGBA(184, 0, 0, 1)
        OnSelect: |-
            =ClearCollect(db2,ForAll(galsectionII.AllItems,{Organization: myOrganization, Title: _question.Text, AnswerIndex1: drpchanges.Selected.Value, AnswerIndex2: drpcontributions.Selected.Value}));
            
            
            Navigate('Section II_EN_v2',ScreenTransition.Fade)
        X: =1302
        Y: =700
        ZIndex: =5

    Arrow1_2 As arrow.backArrow:
        Fill: =RGBA(184, 0, 0, 1)
        OnSelect: =Navigate(AFTER_EN_Networking)
        X: =46
        Y: =687
        ZIndex: =7

    Image4_7 As image:
        Height: =50
        Image: =logo
        OnSelect: =Navigate(Welcome_EN,ScreenTransition.Fade)
        Width: =175
        X: =1177
        Y: =21
        ZIndex: =9

    Group1_4 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =9

        Label2_23 As label:
            FontWeight: =FontWeight.Semibold
            Height: =42
            Size: =9
            Text: =If(lang="En","Municipal Asset Management Program","Programme de gestion des actifs municipaux (PGAM)")
            Width: =365
            X: =12
            ZIndex: =3

        Label2_24 As label:
            FontWeight: =FontWeight.Semibold
            Height: =82
            Size: =17
            Text: |-
                =If(lang="En","Overall, since participating in MAMP, what changes have you observed related to your organization's/ consultancy’s connection with other organizations and networks on asset management? ",
                
                "Dans l’ensemble, depuis que vous avez participé au PGAM, quels changements avez-vous observés en ce qui concerne les liens de votre organisme avec d’autres organismes et réseaux en matière de gestion des actifs?")
            Width: =1123
            X: =12
            Y: =34
            ZIndex: =4

    galsectionII As gallery.variableTemplateHeightGallery:
        DelayItemLoading: =true
        Height: =486
        Items: =FirstN(ImpactMeasureList,2)
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplateFill: |
            =RGBA(232, 34, 34, 0.1)
        TemplateSize: =_question.Height+10
        Width: =1204
        X: =81
        Y: =180
        ZIndex: =10

        _question As label:
            AutoHeight: =true
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(184, 0, 0, 1)
            FontWeight: =FontWeight.Semibold
            Height: =126
            OnSelect: =Select(Parent)
            Size: =11
            Text: =If(lang="En",ThisItem.Questions & Char(13) & Char(13),ThisItem.Questions_FR & Char(13) & Char(13))
            Width: =336
            X: =9
            Y: =8
            ZIndex: =1

        drpchanges As Dropdown.pcfdataset:
            BasePaletteColor: =
            DefaultSelectedItems: |-
                =
                //{Value:{Value:Filter(SNP_QuestionDatabase,Organization=myOrganization,Title=quess.Text).AnswerIndex1}.Value}
                
                If(CountRows(QDB)>0,
                {Value:LookUp(Filter(QDB,Organization=myOrganization),Title=_question.Text,AnswerIndex1)}
                ,{Value:" "})
            DisplayMode: =DisplayMode.Edit
            FontSize: =0
            Height: =32
            Items: |
                =drpchangesArray
            ValidationState: ="None"
            Width: =367
            X: =391
            Y: =12
            ZIndex: =2

        drpcontributions As Dropdown.pcfdataset:
            BasePaletteColor: =
            DefaultSelectedItems: |-
                =
                //{Value:{Value:Filter(SNP_QuestionDatabase,Organization=myOrganization,Title=quess.Text).AnswerIndex1}.Value}
                
                If(CountRows(QDB)>0,
                {Value:LookUp(Filter(QDB,Organization=myOrganization),Title=_question.Text,AnswerIndex2)}
                ,{Value:" "})
            DisplayMode: =DisplayMode.Edit
            FontSize: =0
            Height: =32
            Items: =drpcontributionsArray
            ValidationState: ="None"
            Width: =367
            X: =802
            Y: =12
            ZIndex: =3

    Label2_49 As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Semibold
        Height: =45
        Size: =10
        Text: |-
            =If(lang="En","Changes
            ","Changements")
        Width: =366
        X: =473
        Y: =136
        ZIndex: =11

    Label2_51 As label:
        Align: =Align.Center
        FontWeight: =FontWeight.Semibold
        Height: =53
        Size: =10
        Text: |-
            =If(lang="En","MAMP's Contribution
            ","La contribution du PGAM")
        Width: =183
        X: =959
        Y: =136
        ZIndex: =12

    Label6 As label:
        Text: =CountRows(Filter(ForAll(galsectionII.AllItems,drpchanges.Selected.Value),Not(Value in drpchangesArray)))
        Visible: =false
        X: =1216
        Y: =96
        ZIndex: =22

    Group9_14 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =22

        blank_27 As rectangle:
            Fill: =RGBA(255, 255, 255, 0.9)
            Height: =768
            Visible: =_popup
            Width: =1366
            ZIndex: =14

        Rectangle2_28 As rectangle:
            BorderColor: =RGBA(219, 219, 219, 1)
            BorderThickness: =1
            Fill: =RGBA(255, 255, 255, 1)
            Height: =303
            Visible: =_popup
            Width: =541
            X: =411
            Y: =195
            ZIndex: =15

        Button4_56 As button:
            Fill: =RGBA(184, 0, 0, 1)
            OnSelect: |-
                =
                ClearCollect(QDB,Filter(SNP_QuestionDatabase,Organization=myOrganization));
                
                ClearCollect(db2,ForAll(galsectionII.AllItems,{Organization: myOrganization, Title: _question.Text, AnswerIndex1: drpchanges.Selected.Value, AnswerIndex2: drpcontributions.Selected.Value}));
                
                ClearCollect(db3,ForAll(galsectionIII.AllItems,{Organization: myOrganization, Title: quest.Text, AnswerIndex1: radoption.Selected.Response, AnswerIndex2:""}));
                
                ClearCollect(db4,ForAll(galsectionIV.AllItems,{Organization: myOrganization, Title: quess.Text, AnswerIndex1: drpKP.Selected.Value, AnswerIndex2: ""}));
                ClearCollect(db5,ForAll(galsectionII_1.AllItems,{Organization: myOrganization, Title: _question_1.Text, AnswerIndex1: drpchanges_1.Selected.Value, AnswerIndex2: drpcontributions_1.Selected.Value}));
                ClearCollect(finaldbs,db2,db3,db4,db5);
                
                
                ClearCollect(
                    colGalleryUpdates,
                    ForAll(
                        galfinaldbs.AllItems,
                        {
                            Title:lblQuestion.Text,
                            ID: Value(IDtext.Text),
                            AnswerIndex1:lblAnswerIndex1.Text,
                            AnswerIndex2:lblAnswerIndex2.Text,
                            Language: lang
                        }
                    )
                );
                
                // update SharePoint list with gallery values
                Patch(
                    SNP_QuestionDatabase,
                    colGalleryUpdates.ID,
                    colGalleryUpdates
                );
                
                //Update NetworkMap
                ClearCollect(FinalCollection,SelectedCurrentItems,SelectedItems);
                ClearCollect(MapDB,Filter(S1_SNP,Organization=myOrganization));
                
                //Patch(S1_SNP,ForAll(galfinalMapDB.AllItems,{ID:LookUp(MapDB,UniqueConcat=lblPhase.Text&lblShortName.Text,ID), GalleryName:lblInteraction.Text})));
                //Patch(S1_SNP,Filter(FinalCollection,GalleryName=SelectedLevel,Phase=SelectedPhase)
                
                Patch(S1_SNP,FinalCollection);
                /*
                If(CountRows(MapDB)=0,
                Patch(S1_SNP,FinalCollection),
                If(CountRows(Filter(MapDB,GalleryName=SelectedLevel,Phase=SelectedPhase))=0,
                Patch(S1_SNP,FinalCollection),
                ForAll(
                  galfinalMapDB.AllItems,
                  With({_record:LookUp(MapDB, UniqueConcat=lblPhase.Text&lblShortName.Text)},
                    Patch(S1_SNP, _record,{GalleryName:lblInteraction.Text})  )
                ))
                );*/
                
                
                //SNP Master Update
                
                Set(_lookupReecord,LookUp(SNP_Master,Title=myOrganization));
                
                If(IsBlank(_lookupReecord),
                
                Patch(SNP_Master,Defaults(SNP_Master),
                {Title:myOrganization,Status:{Value:"Draft"},Last_Page:_currentPage}); ,
                
                Patch(SNP_Master,_lookupReecord,{Last_Page:_currentPage}) );
                
                ClearCollect(Master,SNP_Master);
                Set(_loader,false);
                Navigate(Landing,ScreenTransition.Fade);
                Exit()
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =10
            Text: =yesText
            Visible: =_popup
            X: =514
            Y: =378
            ZIndex: =16

        Button4_55 As button:
            Fill: =RGBA(184, 0, 0, 1)
            OnSelect: =Set(_popup,false)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =10
            Text: =cancelText
            Visible: =_popup
            X: =705
            Y: =378
            ZIndex: =17

        Label5_54 As label:
            Align: =Align.Center
            Height: =109
            Size: =12
            Text: =confirmationmsg
            Visible: =_popup
            Width: =525
            X: =420
            Y: =269
            ZIndex: =18

        Icon4_27 As icon.Cancel:
            Color: =RGBA(102, 102, 102, 1)
            Height: =29
            Icon: =Icon.Cancel
            OnSelect: =Set(_popup,false)
            Visible: =_popup
            Width: =32
            X: =893
            Y: =247
            ZIndex: =19

        Label5_55 As label:
            Align: =Align.Center
            Color: =RGBA(184, 0, 0, 1)
            Height: =46
            Size: =8
            Text: =worryText
            Visible: =_popup
            Width: =494
            X: =428
            Y: =427
            ZIndex: =20

        Image3_14 As image:
            Height: =80
            Image: ='Spinner-1s-200px'
            Visible: =_loader
            Width: =64
            X: =432
            Y: =360
            ZIndex: =21

    Label10_2 As label:
        Align: =Align.Right
        Color: =RGBA(184, 0, 0, 1)
        Height: =71
        Size: =10
        Text: =If(lang="En","*unable to proceed. Please, provide answers to all the questions.","*Impossible de continuer. Veuillez répondre à toutes les questions.")
        Visible: =If(Arrow2_2.DisplayMode = DisplayMode.Disabled,true,false)
        Width: =328
        X: =963
        Y: =689
        ZIndex: =23

    Label9_58 As label:
        Align: =Align.Center
        Color: =RGBA(184, 0, 0, 1)
        Height: =54
        OnSelect: |+
            =Set(_popup,true);
            
        Text: =savephrase
        Underline: =true
        Width: =433
        X: =496
        Y: =699
        ZIndex: =24

