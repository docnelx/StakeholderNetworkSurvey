"'Section III_EN' As screen":
    BackgroundImage: =
    Fill: =RGBA(237, 237, 237, 1)
    OnHidden: |-
        =Patch(colTimeRecorder, Last(colTimeRecorder), {End: Now()});
    OnVisible: |-
        =Set(_currentPage,"Section III_EN");
        Set(_popup,false);Collect(colTimeRecorder,{Page: Self.Name,Start:Now(),End: ""});

    Rectangle5_13 As rectangle:
        Fill: =RGBA(255, 255, 255, 0.8)
        Height: =561
        Width: =1366
        Y: =107
        ZIndex: =1

    Rectangle5_11 As rectangle:
        Fill: =RGBA(255, 255, 255, 0.8)
        Height: =574
        Width: =1366
        Y: =107
        ZIndex: =2

    Rectangle5_64 As rectangle:
        Fill: =RGBA(237, 237, 237, 1)
        Height: =98
        Width: =1366
        Y: =669
        ZIndex: =3

    Arrow2_3 As arrow:
        DisplayMode: =If(CountRows(Filter(ForAll(galsectionIII.AllItems,radoption.Selected.Response),IsBlank(Value)))> 0,DisplayMode.Disabled,DisplayMode.Edit)
        Fill: =RGBA(184, 0, 0, 1)
        OnSelect: |-
            =
            ClearCollect(db3,ForAll(galsectionIII.AllItems,{Organization: myOrganization, Title: quest.Text, AnswerIndex1: radoption.Selected.Response, AnswerIndex2:""}));
            
            Navigate('Section IV_EN',ScreenTransition.Fade)
        X: =1302
        Y: =687
        ZIndex: =6

    Arrow1_3 As arrow.backArrow:
        Fill: =RGBA(184, 0, 0, 1)
        OnSelect: =Navigate('Section II_EN')
        X: =46
        Y: =687
        ZIndex: =7

    Image4_10 As image:
        Height: =50
        Image: =logo
        OnSelect: =Navigate(Welcome_EN,ScreenTransition.Fade)
        Width: =175
        X: =1177
        Y: =21
        ZIndex: =8

    galsectionIII As gallery.variableTemplateHeightGallery:
        DelayItemLoading: =true
        Height: =550
        Items: =ChangeList
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplateSize: =145
        Width: =1366
        Y: =119
        ZIndex: =9

        quest As label:
            Color: =RGBA(184, 0, 0, 1)
            FontWeight: =FontWeight.Semibold
            Height: =31
            OnSelect: =Select(Parent)
            Text: =If(lang="En",ThisItem.Change,ThisItem.Change_FR)
            Width: =702
            X: =12
            ZIndex: =1

        radoption As radio:
            Default: |-
                =
                //{Value:{Value:Filter(SNP_QuestionDatabase,Organization=myOrganization,Title=quess.Text).AnswerIndex1}.Value}
                
                If(CountRows(QDB)>0,
                LookUp(Filter(QDB,Organization=myOrganization),Title=quest.Text,AnswerIndex1)
                ,"")
            Fill: =RGBA(237, 237, 237, 1)
            Height: =53
            Items: |+
                =colResponses.Response
                
            Layout: =Layout.Horizontal
            OnSelect: =Select(Parent)
            PaddingBottom: =0
            RadioSize: |
                =30
            Size: =9
            Width: =1344
            X: =12
            Y: =43
            ZIndex: =2

    Group1_7 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =9

        Label2_39 As label:
            FontWeight: =FontWeight.Semibold
            Height: =42
            Size: =9
            Text: ="Municipal Asset Management Program"
            Width: =365
            X: =12
            Y: =6
            ZIndex: =4

        Label2_40 As label:
            FontWeight: =FontWeight.Semibold
            Height: =66
            Size: =17
            Text: |
                =If(lang="En","How did the following factors contribute changes to your internal AM capacity?","Comment les autres facteurs suivants ont-ils contribué aux changements de votre capacité interne en matière de gestion des actifs?")
            Width: =1031
            X: =12
            Y: =41
            ZIndex: =5

    Label9_27 As label:
        Align: =Align.Right
        Color: =RGBA(184, 0, 0, 1)
        Height: =50
        OnSelect: |+
            =Set(_popup,true);
            
        Text: ="Save and exit to continue later"
        Underline: =true
        Width: =263
        X: =537
        Y: =693
        ZIndex: =10

    Label10_3 As label:
        Align: =Align.Right
        Color: =RGBA(184, 0, 0, 1)
        Height: =71
        Size: =10
        Text: ="**unable to proceed. Please, provide answers to all the questions."
        Visible: =If(Arrow2_3.DisplayMode = DisplayMode.Disabled,true,false)
        Width: =328
        X: =963
        Y: =689
        ZIndex: =19

    Group9_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =20

        blank_14 As rectangle:
            Fill: =RGBA(255, 255, 255, 0.9)
            Height: =768
            Visible: =_popup
            Width: =1366
            ZIndex: =11

        Rectangle2_15 As rectangle:
            BorderColor: =RGBA(219, 219, 219, 1)
            BorderThickness: =1
            Fill: =RGBA(255, 255, 255, 1)
            Height: =303
            Visible: =_popup
            Width: =541
            X: =411
            Y: =195
            ZIndex: =12

        Button4_30 As button:
            Fill: =RGBA(184, 0, 0, 1)
            OnSelect: |-
                =
                Set(_loader,true);
                
                //Questionnaire Update
                
                ClearCollect(QDB,Filter(SNP_QuestionDatabase,Organization=myOrganization));
                
                ClearCollect(db2,ForAll(galsectionII.AllItems,{Organization: myOrganization, Title: _question.Text, AnswerIndex1: drpchanges.Selected.Value, AnswerIndex2: drpcontributions.Selected.Value}));
                
                ClearCollect(db3,ForAll(galsectionIII.AllItems,{Organization: myOrganization, Title: quest.Text, AnswerIndex1: radoption.Selected.Response, AnswerIndex2:""}));
                
                ClearCollect(db4,ForAll(galsectionIV.AllItems,{Organization: myOrganization, Title: quess.Text, AnswerIndex1: drpKP.Selected.Value, AnswerIndex2: ""}));
                ClearCollect(db5,ForAll(galsectionII_1.AllItems,{Organization: myOrganization, Title: _question_1.Text, AnswerIndex1: drpchanges_1.Selected.Value, AnswerIndex2: drpcontributions_1.Selected.Value}));
                ClearCollect(finaldbs,db2,db3,db4,db5);
                
                If(CountRows(QDB)=0,
                Patch(SNP_QuestionDatabase,finaldbs),
                Patch(SNP_QuestionDatabase,ForAll(galfinaldbs.AllItems,{ID:LookUp(QDB,Title=lblQuestion.Text,ID),AnswerIndex1:lblAnswerIndex1.Text,AnswerIndex2:lblAnswerIndex2.Text})));
                
                // Mapping DB Update
                
                ClearCollect(FinalCollection,SelectedCurrentItems,SelectedItems);
                ClearCollect(MapDB,Filter(S1_SNP,Organization=myOrganization));
                
                If(CountRows(MapDB)=0,
                Patch(S1_SNP,FinalCollection),
                Patch(S1_SNP,ForAll(galfinalMapDB.AllItems,{ID:LookUp(MapDB,UniqueConcat=lblPhase.Text&lblShortName.Text,ID), GalleryName:lblInteraction.Text})));
                
                
                
                //SNP Master Update
                
                Set(_lookupReecord,LookUp(SNP_Master,Title=myOrganization));
                
                If(IsBlank(_lookupReecord),
                
                Patch(SNP_Master,Defaults(SNP_Master),
                {Title:myOrganization,Status:{Value:"Draft"},Last_Page:_currentPage}); ,
                
                Patch(SNP_Master,_lookupReecord,{Last_Page:_currentPage}) );
                
                ClearCollect(Master,SNP_Master);
                Set(_loader,false);
                Navigate(Landing,ScreenTransition.Fade);
                Exit()
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =10
            Text: ="Yes, Save & Exit"
            Visible: =_popup
            X: =514
            Y: =378
            ZIndex: =13

        Button4_29 As button:
            Fill: =RGBA(184, 0, 0, 1)
            OnSelect: =Set(_popup,false)
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =10
            Text: ="Cancel"
            Visible: =_popup
            X: =705
            Y: =378
            ZIndex: =14

        Label5_28 As label:
            Align: =Align.Center
            Height: =109
            Size: =12
            Text: ="Are you sure you want to save your current status and exit from this survey? "
            Visible: =_popup
            Width: =525
            X: =420
            Y: =269
            ZIndex: =15

        Icon4_14 As icon.Cancel:
            Color: =RGBA(102, 102, 102, 1)
            Height: =29
            Icon: =Icon.Cancel
            OnSelect: =Set(_popup,false)
            Visible: =_popup
            Width: =32
            X: =893
            Y: =247
            ZIndex: =16

        Label5_29 As label:
            Align: =Align.Center
            Color: =RGBA(184, 0, 0, 1)
            Height: =46
            Size: =8
            Text: ="* Do not worry, the survey would save your progress and restart from this page upon resumption"
            Visible: =_popup
            Width: =494
            X: =428
            Y: =427
            ZIndex: =17

        Image3_1 As image:
            Height: =80
            Image: ='Spinner-1s-200px'
            Visible: =_loader
            Width: =64
            X: =432
            Y: =360
            ZIndex: =18

